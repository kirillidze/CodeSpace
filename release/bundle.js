!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){var o,a,i={},s=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=o.apply(this,arguments)),a}),r=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var o=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,n);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}}(),u=null,c=0,l=[],h=n(3);function d(e,t){for(var n=0;n<e.length;n++){var o=e[n],a=i[o.id];if(a){a.refs++;for(var s=0;s<a.parts.length;s++)a.parts[s](o.parts[s]);for(;s<o.parts.length;s++)a.parts.push(v(o.parts[s],t))}else{var r=[];for(s=0;s<o.parts.length;s++)r.push(v(o.parts[s],t));i[o.id]={id:o.id,refs:1,parts:r}}}}function p(e,t){for(var n=[],o={},a=0;a<e.length;a++){var i=e[a],s=t.base?i[0]+t.base:i[0],r={css:i[1],media:i[2],sourceMap:i[3]};o[s]?o[s].parts.push(r):n.push(o[s]={id:s,parts:[r]})}return n}function f(e,t){var n=r(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=l[l.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=r(e.insertAt.before,n);n.insertBefore(t,a)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function b(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var o=function(){0;return n.nc}();o&&(e.attrs.nonce=o)}return y(t,e.attrs),f(e,t),t}function y(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function v(e,t){var n,o,a,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var s=c++;n=u||(u=b(t)),o=w.bind(null,n,s,!1),a=w.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),f(e,t),t}(t),o=function(e,t,n){var o=n.css,a=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&a;(t.convertToAbsoluteUrls||i)&&(o=h(o));a&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var s=new Blob([o],{type:"text/css"}),r=e.href;e.href=URL.createObjectURL(s),r&&URL.revokeObjectURL(r)}.bind(null,n,t),a=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=b(t),o=function(e,t){var n=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),a=function(){g(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else a()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return d(n,t),function(e){for(var o=[],a=0;a<n.length;a++){var s=n[a];(r=i[s.id]).refs--,o.push(r)}e&&d(p(e,t),t);for(a=0;a<o.length;a++){var r;if(0===(r=o[a]).refs){for(var u=0;u<r.parts.length;u++)r.parts[u]();delete i[r.id]}}}};var m,_=(m=[],function(e,t){return m[e]=t,m.filter(Boolean).join("\n")});function w(e,t,n,o){var a=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=_(t,a);else{var i=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}},function(e,t,n){var o=n(2);"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(0)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,o=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var a,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(a=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")})}},function(e,t,n){var o=n(5);"string"==typeof o&&(o=[[e.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(0)(o,a);o.locals&&(e.exports=o.locals)},function(e,t,n){},function(e,t,n){e.exports=n.p+"img/favicon.png"},function(e,t,n){e.exports=n.p+"img/logo.png"},function(e,t,n){e.exports=n.p+"img/layout-plaster.png"},function(e,t,n){"use strict";n.r(t);n(1),n(4),n(6),n(7),n(8);function o(e,t,n){var o=ace.edit(e);o.setTheme(t),o.session.setMode(n),o.session.setUseWrapMode(!0),o.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0})}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.topics={}}var t,n,o;return t=e,(n=[{key:"sub",value:function(e,t){if("function"==typeof t){var n=this.topics[e]||[];-1==n.indexOf(t)&&(n.push(t),this.topics[e]=n)}}},{key:"pub",value:function(e,t){var n=this.topics[e]||[],o=!0,a=!1,i=void 0;try{for(var s,r=n[Symbol.iterator]();!(o=(s=r.next()).done);o=!0){(0,s.value)(t)}}catch(e){a=!0,i=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}}},{key:"remove",value:function(e,t){var n=this.topics[e]||[],o=n.indexOf(t);o>-1&&(n.splice(o,1),this.topics[e]=n)}},{key:"removeAll",value:function(e){delete this.topics[e]}}])&&a(t.prototype,n),o&&a(t,o),e}();function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r="https://fe.it-academy.by/AjaxStringStorage2.php",u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userNick=null,this.userPass=null,this.activeUser=null,this.users=[],this.layoutLink="../img/layout-plaster.png",this.preloadedImagesH={},this.changes=new i,this.createPromise=function(e,t){return new Promise(function(n,o){try{$.ajax({url:r,type:"POST",cache:!1,dataType:"json",context:e,data:t,success:n,error:o})}catch(e){console.log(e)}})},this.userValidation=function(e,t,n){return n.test(e)},$.validator.addMethod("nickValue",this.userValidation,"The name must start with a letter and can contain an underscore and a number"),$.validator.addMethod("passValue",this.userValidation,"The password must have numbers, uppercase and lowercase letters"),this.validateNickMap={required:!0,minlength:2,maxlength:12,nickValue:/^[A-Za-zА-Яа-я]+[\wА-я]*$/},this.validatePassMap={required:!0,minlength:6,maxlength:20,passValue:/(\d+[A-ZА-Я]+[a-zа-я]+)|(\d+[a-zа-я]+[A-ZА-Я]+)|([A-ZА-Я]+[a-zа-я]+\d+)|([A-ZА-Я]+\d+[a-zа-я]+)|([a-zа-я]+[A-ZА-Я]+\d+)|([a-zа-я]+\d+[A-ZА-Я]+)/}}var t,n,o;return t=e,(n=[{key:"loadServerData",value:function(){var e=this;this.createPromise(this,{f:"READ",n:"CodeSpace"}).then(function(t){if(void 0!==t.error)alert(t.error);else if(""!==t){var n=JSON.parse(t.result);for(var o in n)e.users.push({userName:o,password:n[o].password});e.changes.pub("changeOnload","changesWasPublished")}}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}},{key:"preloadImage",value:function(e){e in this.preloadedImagesH||((new Image).src=e,this.preloadedImagesH[e]=!0)}},{key:"setLogInInfo",value:function(e,t){this.activeUser=null,this.userNick=e,this.userPass=t;for(var n=0;n<this.users.length;n++)if(this.users[n].userName==this.userNick&&this.users[n].password==this.userPass){this.activeUser=this.users[n].userName;break}this.activeUser?(localStorage.user=this.activeUser+"",this.changes.pub("changeUser",this.activeUser)):this.changes.pub("dataNotFound","changesWasPublished")}},{key:"setSignUpInfo",value:function(e,t,n){this.activeUser=null,this.userNick=e,this.userPass=t;for(var o=0;o<this.users.length;o++){if(this.users[o].userName.toLowerCase()==this.userNick.toLowerCase()){this.activeUser=!1;break}this.activeUser=this.userNick}n||(this.activeUser?(localStorage.user=this.activeUser+"",this.createUser(this.userNick,this.userPass)):this.changes.pub("userWasFound","changesWasPublished"))}},{key:"createUser",value:function(e,t){var n=this,o=this;this.createPromise(o,{f:"LOCKGET",n:"CodeSpace",p:123}).then(function(a){var i,s,r,u=JSON.parse(a.result),c="project"+Date.now();return u[e]={password:t,settings:{autoUpdate:!0,autoSave:!1},projects:(i={},s=c,r={html:"",css:"",js:"",title:"New Project"},s in i?Object.defineProperty(i,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[s]=r,i)},n.createPromise(o,{f:"UPDATE",n:"CodeSpace",p:123,v:JSON.stringify(u)}).then(function(e){console.log("Сохранено: "+e.result),"OK"==e.result&&n.changes.pub("changeUser",n.activeUser)}).catch(function(e){console.log("На этапе записи на сервер случилась ошибка: "+e)})}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}},{key:"resizeContent",value:function(e,t){var n=e.window-e.header-e.footer;this.changes.pub("changeContentHeight",n),t>950&&this.changes.pub("changePageWidth","changesWasPublished")}},{key:"changeButtonContainer",value:function(e){e<=950&&this.changes.pub("hideButtonContainer","changesWasPublished")}}])&&s(t.prototype,n),o&&s(t,o),e}();function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,this.myModel.changes.sub("changeOnload",this.update.bind(this)),this.myModel.changes.sub("changeContentHeight",this.updateContentHeight.bind(this)),this.myModel.changes.sub("changeButtonContainer",this.toggleButtonContainer.bind(this)),this.myModel.changes.sub("changePageWidth",this.showButtonContainer.bind(this)),this.myModel.changes.sub("hideButtonContainer",this.toggleButtonContainer.bind(this))}var t,n,o;return t=e,(n=[{key:"update",value:function(){$("#AUTO-UPDATE").css("display","none"),$(".header__auto-update-label").css("display","none"),$("#RUN-BUTTON").css("display","none"),$("#SAVE-BUTTON").css("display","none"),$("#LOGOUT-BUTTON").css("display","none"),$(".main__user-container").css("display","none"),$(".main__ouput-window").css("display","none"),$(".header__dashboard-link").css("display","none"),$(".main__projects-list").css("display","none"),$(".main__projects-list").html(""),$("#CREATE-BUTTON").css("display","none"),$(".main__promo-container").css("display","block"),$("#LOGIN-BUTTON").css("display","inline-block"),$("#SIGNUP-BUTTON").css("display","inline-block"),$("#LOGIN-BUTTON, #SIGNUP-BUTTON").button(),$(".layout").css("background-image","url(".concat(this.myModel.layoutLink,")")),$(".header__title, .header__title__username, .header__title__projectname").css("display","none")}},{key:"updateContentHeight",value:function(e){$(".main").height(e)}},{key:"toggleButtonContainer",value:function(){$(".header__button-container, .header__button-container-layout").fadeToggle()}},{key:"showButtonContainer",value:function(){$(".header__button-container, .header__button-container-layout").removeAttr("style")}}])&&c(t.prototype,n),o&&c(t,o),e}();function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$(".header__bars-menu, .header__button-container-layout, #SIGNUP-BUTTON, #LOGIN-BUTTON").unbind("click"),$(window).resize(this.startResizeContent.bind(this)),$("#LOGIN-BUTTON").click(this.pubClickOnButton.bind(this,"logIn")),$("#SIGNUP-BUTTON").click(this.pubClickOnButton.bind(this,"signUp")),$(".header__bars-menu, .header__button-container-layout").click(this.startToggleButtonContainer.bind(this)),this.startLoading(),this.startResizeContent()}var t,n,o;return t=e,(n=[{key:"startLoading",value:function(){this.myModel.loadServerData(),this.myModel.preloadImage(this.myModel.layoutLink)}},{key:"pubClickOnButton",value:function(e){this.myModel.changes.pub("changePopup",e);var t=$(window).outerWidth();this.myModel.changeButtonContainer(t)}},{key:"startResizeContent",value:function(){var e={window:$(window).outerHeight(!0),header:$(".header").outerHeight(!0),footer:$(".footer").outerHeight(!0)},t=$(window).outerWidth();this.myModel.resizeContent(e,t)}},{key:"startToggleButtonContainer",value:function(){this.myModel.changes.pub("changeButtonContainer","changesWasPublished")}}])&&h(t.prototype,n),o&&h(t,o),e}();function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,this.myModel.changes.sub("changePopup",this.showPopup.bind(this)),this.myModel.changes.sub("hidePopup",this.hidePopup.bind(this)),this.myModel.changes.sub("changeUser",this.hidePopup.bind(this)),this.myModel.changes.sub("dataNotFound",this.showErrorLogIn.bind(this)),this.myModel.changes.sub("userWasFound",this.showErrorSignUp.bind(this)),this.myModel.changes.sub("changePopupData",this.hideErrorSignUp.bind(this))}var t,n,o;return t=e,(n=[{key:"showPopup",value:function(e){$(".layout, .popup").css("display","block"),"logIn"===e?($(".popup__title_logIn").css("display","block"),$('.popup__button[value="Log In"]').css("display","inline-block")):"signUp"===e&&($(".popup__title_signUp").css("display","block"),$('.popup__button[value="Sign Up"]').css("display","inline-block"))}},{key:"hidePopup",value:function(){$(".layout, .popup, .popup__title, .popup__button_hide, .popup__error").css("display","none"),$(".popup__text-place").val("")}},{key:"showErrorLogIn",value:function(){$(".popup__error_logIn").css("display","inline-block")}},{key:"showErrorSignUp",value:function(){$(".popup__error_signUp").css("display","inline-block")}},{key:"hideErrorSignUp",value:function(){$(".popup__error_signUp").css("display","none")}}])&&p(t.prototype,n),o&&p(t,o),e}();function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$('.popup__button[value="Log In"], .popup__button[value="Sign Up"]').unbind("click"),$('.layout, .popup__close-cross, .popup__button[value="Close"]').click(this.pubClosePopup.bind(this)),$('.popup__button[value="Log In"]').click(this.startSetLogInInfo.bind(this)),$('.popup__button[value="Sign Up"]').click(this.startSetSignUpInfo.bind(this)),$("#POPUP-FORM").validate({rules:{"user-nick":this.myModel.validateNickMap,"user-pass":this.myModel.validatePassMap}})}var t,n,o;return t=e,(n=[{key:"pubClosePopup",value:function(){this.myModel.changes.pub("hidePopup","changesWasPublished")}},{key:"startSetLogInInfo",value:function(){var e=$('.popup__text-place[name="user-nick"]').val(),t=$('.popup__text-place[name="user-pass"]').val();this.myModel.setLogInInfo(e,t)}},{key:"startSetSignUpInfo",value:function(){var e=$('.popup__text-place[name="user-nick"]').val(),t=$('.popup__text-place[name="user-pass"]').val(),n=$(".popup__text-place").hasClass("error");this.myModel.changes.pub("changePopupData","changesWasPublished"),this.myModel.setSignUpInfo(e,t,n)}}])&&g(t.prototype,n),o&&g(t,o),e}();function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user=t,this.list=null,this.changes=new i,this.createPromise=function(e,t){return new Promise(function(n,o){try{$.ajax("https://fe.it-academy.by/AjaxStringStorage2.php",{type:"POST",cache:!1,dataType:"json",context:e,data:t,success:n,error:o})}catch(e){console.log(e)}})}}var t,n,o;return t=e,(n=[{key:"loadServerData",value:function(){var e=this;this.createPromise(this,{f:"READ",n:"CodeSpace"}).then(function(t){if(void 0!==t.error)alert(t.error);else if(""!==t){var n=JSON.parse(t.result);n[e.user].projects&&(e.list=n[e.user].projects)}e.changes.pub("changeListOnload",e.list)}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}},{key:"logOut",value:function(){localStorage.clear(),sessionStorage.clear(),this.changes.pub("logOut","changesWasPublished")}},{key:"createNewProject",value:function(){var e=Date.now();this.changes.pub("createNewProject",e)}},{key:"resizeContent",value:function(e,t){var n=e.window-e.header-e.footer;this.changes.pub("changeContentHeight",n),t>950&&this.changes.pub("changePageWidth","changesWasPublished")}},{key:"deleteProject",value:function(e){var t=this,n=this;this.createPromise(n,{f:"LOCKGET",n:"CodeSpace",p:123}).then(function(o){var a=JSON.parse(o.result);return delete a[t.user].projects[e],t.createPromise(n,{f:"UPDATE",n:"CodeSpace",p:123,v:JSON.stringify(a)}).then(function(n){console.log("Удалено: "+n.result),"OK"==n.result&&t.changes.pub("changeProjectList",e)}).catch(function(e){console.log("На этапе записи на сервер случилась ошибка: "+e)})}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}}])&&y(t.prototype,n),o&&y(t,o),e}();function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,this.myModel.changes.sub("changeListOnload",this.updateList.bind(this)),this.myModel.changes.sub("changeContentHeight",this.updateContentHeight.bind(this)),this.myModel.changes.sub("changeProjectList",this.showMessage.bind(this)),this.myModel.changes.sub("changeProjectList",this.deleteProjectFromList.bind(this)),this.myModel.changes.sub("changePageWidth",this.showButtonContainer.bind(this)),this.myModel.changes.sub("changeButtonContainer",this.toggleButtonContainer.bind(this))}var t,n,o;return t=e,(n=[{key:"updateList",value:function(e){for(var t in $("#AUTO-UPDATE").css("display","none"),$(".header__auto-update-label").css("display","none"),$("#RUN-BUTTON").css("display","none"),$("#SAVE-BUTTON").css("display","none"),$("#LOGIN-BUTTON").css("display","none"),$("#SIGNUP-BUTTON").css("display","none"),$(".main__promo-container").css("display","none"),$(".main__user-container").css("display","none"),$(".main__ouput-window").css("display","none"),$(".header__dashboard-link").css("display","none"),$("#CREATE-BUTTON").css("display","inline-block"),$("#LOGOUT-BUTTON").css("display","inline-block"),$(".main__projects-list").html(""),$(".main__projects-list").css("display","block"),$("#LOGOUT-BUTTON, #CREATE-BUTTON").button(),e){var n=$("<div>");n.addClass("main__projects-list__wrapper"),$("<i>").addClass("far fa-trash-alt main__projects-list__delete").attr("data-hash",t).appendTo(n),$("<a>",{type:"button",class:"link",href:"#"+t,onclick:"(e) => {e.preventDefault();}",text:e[t].title}).appendTo(n),n.appendTo($(".main__projects-list"))}$(".header__title__username").text(this.myModel.user),$(".header__title, .header__title__username").css("display","inline-block"),$(".header__title__projectname").css("display","none"),$(".header__title__input").hide()}},{key:"updateContentHeight",value:function(e){$(".main").height(e)}},{key:"showMessage",value:function(){$(".save, .delete__message, .layout__save__message").css("display","block").fadeOut(3e3,"easeInQuart")}},{key:"deleteProjectFromList",value:function(e){$("[data-hash = ".concat(e,"]")).parent().remove()}},{key:"toggleButtonContainer",value:function(){$(".header__button-container, .header__button-container-layout").fadeToggle()}},{key:"showButtonContainer",value:function(){$(".header__button-container, .header__button-container-layout").removeAttr("style")}}])&&m(t.prototype,n),o&&m(t,o),e}();function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$(".header__bars-menu, .header__button-container-layout, #CREATE-BUTTON, .main__projects-list").unbind("click"),$(window).resize(this.startResizeContent.bind(this)),$("#LOGOUT-BUTTON").click(this.startLogOut.bind(this)),$("#CREATE-BUTTON").click(this.startCreateNewProject.bind(this)),$(".main__projects-list").bind("click",this.deleteProject.bind(this)),$(".header__bars-menu, .header__button-container-layout").click(this.startToggleButtonContainer.bind(this)),this.startLoading(),this.startResizeContent()}var t,n,o;return t=e,(n=[{key:"startLoading",value:function(){this.myModel.loadServerData()}},{key:"startLogOut",value:function(){this.myModel.logOut()}},{key:"startCreateNewProject",value:function(){this.myModel.createNewProject()}},{key:"startResizeContent",value:function(){var e={window:$(window).outerHeight(!0),header:$(".header").outerHeight(!0),footer:$(".footer").outerHeight(!0)},t=$(window).outerWidth();this.myModel.resizeContent(e,t)}},{key:"startToggleButtonContainer",value:function(){this.myModel.changes.pub("changeButtonContainer","changesWasPublished")}},{key:"deleteProject",value:function(e){var t=e.target.getAttribute("data-hash");t&&this.myModel.deleteProject(t)}}])&&w(t.prototype,n),o&&w(t,o),e}();function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var T="https://fe.it-academy.by/AjaxStringStorage2.php",U=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user=n,this.project=t,this.autoUpdate=null,this.html=null,this.css=null,this.js=null,this.title=null,this.changes=new i,this.contentSaved=!0,this.timer=0,this.createPromise=function(e,t){return new Promise(function(n,o){try{$.ajax({url:T,type:"POST",cache:!1,dataType:"json",context:e,data:t,success:n,error:o})}catch(e){console.log(e)}})}}var t,n,o;return t=e,(n=[{key:"loadServerData",value:function(){var e=this;this.createPromise(this,{f:"READ",n:"CodeSpace"}).then(function(t){if(void 0!==t.error)alert(t.error);else if(""!==t){var n=JSON.parse(t.result);void 0!==sessionStorage.autoUpdate?e.autoUpdate=JSON.parse(sessionStorage.autoUpdate):(e.autoUpdate=n[e.user].settings.autoUpdate,sessionStorage.autoUpdate=JSON.stringify(e.autoUpdate)),n[e.user].projects[e.project]?(e.html=n[e.user].projects[e.project].html,e.css=n[e.user].projects[e.project].css,e.js=n[e.user].projects[e.project].js,e.title=n[e.user].projects[e.project].title):(e.html="",e.css="",e.js="",e.title="".concat(e.project)),e.changes.pub("changeOnload",{html:e.html,css:e.css,js:e.js,title:e.title,autoUpdate:e.autoUpdate})}}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}},{key:"savingData",value:function(e){var t=this,n=this;this.createPromise(n,{f:"LOCKGET",n:"CodeSpace",p:123}).then(function(o){var a=JSON.parse(o.result);return a[t.user].settings.autoUpdate=t.autoUpdate,a[t.user].projects[t.project]=e,t.createPromise(n,{f:"UPDATE",n:"CodeSpace",p:123,v:JSON.stringify(a)}).then(function(e){console.log("Сохранение: "+e.result),"OK"==e.result&&(t.contentSaved=!0,t.changes.pub("contentSaved","saved"))}).catch(function(e){console.log("На этапе записи на сервер случилась ошибка: "+e)})}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}},{key:"pubUnloadMessage",value:function(e){this.contentSaved||(e.returnValue="message")}},{key:"setContent",value:function(e){this.html=e.html,this.css=e.css,this.js=e.js,this.title=e.title,this.changes.pub("changeContent",e),this.contentSaved=!1}},{key:"setContentByTimer",value:function(e,t){var n=/^[89]|(13)|(32)|((4|18)[6-9])|(([5-8]|10)\d)|(9[06-9])|(11[01])|((19|22)[0-2])|(219)$/.test(e.which);this.autoUpdate&&n&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.setContent.bind(this,t),500)),this.contentSaved=!1}},{key:"setAutoUpdate",value:function(e){this.autoUpdate=e.autoUpdate,sessionStorage.autoUpdate=e.autoUpdate,this.changes.pub("changeAutoUpdate",e)}},{key:"logOut",value:function(){localStorage.clear(),sessionStorage.clear(),this.changes.pub("logOut","changesWasPublished")}},{key:"createNewProject",value:function(){var e=Date.now();this.changes.pub("createNewProject",e)}},{key:"resizeContent",value:function(e,t){var n=e.window-e.header-e.footer;this.changes.pub("changeContentHeight",n),t>950&&this.changes.pub("changePageWidth","changesWasPublished")}},{key:"changeButtonContainer",value:function(e){e<=950&&this.changes.pub("hideButtonContainer","changesWasPublished")}}])&&k(t.prototype,n),o&&k(t,o),e}();function P(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var j=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$(".main__window-title").unbind(),this.toggleRunButtonHandler=this.toggleRunButton.bind(this),this.myModel.changes.sub("changeOnload",this.updatePage.bind(this)),this.myModel.changes.sub("changeAutoUpdate",this.toggleRunButtonHandler),this.myModel.changes.sub("changeContentHeight",this.updateContentHeight.bind(this)),this.myModel.changes.sub("contentSaved",this.showSaveMessage.bind(this)),this.myModel.changes.sub("changePageWidth",this.showButtonContainer.bind(this)),this.myModel.changes.sub("changeButtonContainer",this.toggleButtonContainer.bind(this)),this.myModel.changes.sub("hideButtonContainer",this.toggleButtonContainer.bind(this))}var t,n,o;return t=e,(n=[{key:"updatePage",value:function(e){$(".header__auto-update-label").css("display","inline-block"),$("#RUN-BUTTON").css("display","inline-block"),$("#SAVE-BUTTON").css("display","inline-block"),$("#LOGOUT-BUTTON").css("display","inline-block"),$("#CREATE-BUTTON").css("display","inline-block"),$(".main__user-container").css("display","block"),$(".main__ouput-window").css("display","block"),$(".header__dashboard-link").css("display","inline-block"),$(".main__projects-list").css("display","none"),$(".header__title").css("display","inline-block"),$(".header__title__username, .header__title__projectname").css("display","inline-block"),$(".header__title__username").text("".concat(this.myModel.user," / ")),$(".header__title__input").hide(),$("#AUTO-UPDATE").prop("checked",e.autoUpdate),this.toggleRunButton(e),$("#LOGOUT-BUTTON, #CREATE-BUTTON, #SAVE-BUTTON, #RUN-BUTTON").button(),$(".header__dashboard-link").button(),$(".main__window-title").click(function(){$(this).next().slideToggle()})}},{key:"showSaveMessage",value:function(){$(".save, .save__message, .layout__save__message").css("display","block").fadeOut(3e3,"easeInQuart")}},{key:"toggleRunButton",value:function(e){e.autoUpdate?($("#RUN-BUTTON").hide(0),$(".header__auto-update-label").css("background-color","#2783b0"),$(".header__auto-update-switcher").css("left","35px")):($("#RUN-BUTTON").show(0),$(".header__auto-update-label").css("background-color","#36383f"),$(".header__auto-update-switcher").css("left","5px"))}},{key:"unsubscribe",value:function(){this.myModel.changes.remove("changeAutoUpdate",this.toggleRunButtonHandler)}},{key:"updateContentHeight",value:function(e){$(".main").height(e)}},{key:"toggleButtonContainer",value:function(){$(".header__button-container, .header__button-container-layout").fadeToggle()}},{key:"showButtonContainer",value:function(){$(".header__button-container, .header__button-container-layout").removeAttr("style")}}])&&P(t.prototype,n),o&&P(t,o),e}();function C(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var S=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$(".header__bars-menu, .header__button-container-layout, .header__dashboard-link, #CREATE-BUTTON, #LOGOUT-BUTTON").unbind("click"),$("#LOGOUT-BUTTON").click(this.startLogOut.bind(this)),$("#CREATE-BUTTON").click(this.startCreateNewProject.bind(this)),$(window).resize(this.startResizeContent.bind(this)),$(".header__bars-menu, .header__button-container-layout").click(this.startToggleButtonContainer.bind(this)),$(".header__dashboard-link").click(this.startChangeButtonContainer.bind(this)),window.onbeforeunload=this.startUnload.bind(this),this.startLoading(),this.startResizeContent()}var t,n,o;return t=e,(n=[{key:"startLoading",value:function(){this.myModel.loadServerData()}},{key:"startLogOut",value:function(){this.myModel.logOut()}},{key:"startCreateNewProject",value:function(){this.myModel.createNewProject()}},{key:"startUnload",value:function(e){this.myModel.pubUnloadMessage(e)}},{key:"startResizeContent",value:function(){var e={window:$(window).outerHeight(!0),header:$(".header").outerHeight(!0),footer:$(".footer").outerHeight(!0)},t=$(window).outerWidth();this.myModel.resizeContent(e,t)}},{key:"startToggleButtonContainer",value:function(){this.myModel.changes.pub("changeButtonContainer","changesWasPublished")}},{key:"startChangeButtonContainer",value:function(){var e=$(window).outerWidth();this.myModel.changeButtonContainer(e)}}])&&C(t.prototype,n),o&&C(t,o),e}();function N(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var M=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,this.myModel.changes.sub("changeOnload",this.updateWin.bind(this)),this.myModel.changes.sub("changeByDblclick",this.setEditable.bind(this)),this.myModel.changes.sub("changeByBlur",this.removeEditable.bind(this)),this.myModel.changes.sub("changeByKeydown",this.removeEditableByKeydown.bind(this))}var t,n,o;return t=e,(n=[{key:"updateWin",value:function(e){ace.edit("HTML").setValue(e.html),ace.edit("CSS").setValue(e.css),ace.edit("JS").setValue(e.js),$(".header__title__projectname").text(e.title),$("#AUTO-UPDATE").prop("checked",e.autoUpdate),e.autoUpdate?$("#RUN-BUTTON").hide(0):$("#RUN-BUTTON").show(0)}},{key:"setEditable",value:function(e){$(".header__title__projectname").hide().next(".header__title__input").val($(".header__title__projectname").text()).show().focus()}},{key:"removeEditable",value:function(e){$(".header__title__input").hide().prev(".header__title__projectname").show()}},{key:"removeEditableByKeydown",value:function(e){if("Escape"==e.key)$(".header__title__input").hide().prev(".header__title__projectname").show();else{if("Enter"!=e.key)return;$(".header__title__input").hide().prev(".header__title__projectname").text($(".header__title__input").val()).show()}}}])&&N(t.prototype,n),o&&N(t,o),e}();function B(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$("#SAVE-BUTTON, #RUN-BUTTON").unbind("click"),$(".main__user-container").unbind("keyup"),$(".header__title__projectname").unbind(),$(".main__user-container").keyup(this.startSetContentByTimer.bind(this)),$("#RUN-BUTTON").click(this.startSetContent.bind(this)),$("#SAVE-BUTTON").click(this.startSaving.bind(this)),$(".header__title__projectname").dblclick(this.pubDblclickOnProjectName.bind(this)),$(".header__title__input").blur(this.pubBlurProjectName.bind(this)),$(".header__title__input").keydown(this.pubKeydownInProjectName.bind(this))}var t,n,o;return t=e,(n=[{key:"startSaving",value:function(){var e=this._getData();this.myModel.savingData(e)}},{key:"_getData",value:function(){return{html:ace.edit("HTML").getValue(),css:ace.edit("CSS").getValue(),js:ace.edit("JS").getValue(),title:$(".header__title__projectname").text()}}},{key:"startSetContent",value:function(){var e=this._getData();this.myModel.setContent(e)}},{key:"startSetContentByTimer",value:function(e){var t=this._getData();this.myModel.setContentByTimer(e,t)}},{key:"pubDblclickOnProjectName",value:function(){this.myModel.changes.pub("changeByDblclick","changesWasPublished")}},{key:"pubBlurProjectName",value:function(){this.myModel.changes.pub("changeByBlur","changesWasPublished")}},{key:"pubKeydownInProjectName",value:function(e){this.myModel.changes.pub("changeByKeydown",e)}}])&&B(t.prototype,n),o&&B(t,o),e}();function A(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,this.updateOutputHandler=this.updateOutput.bind(this),this.toggleAutoUpdateHandler=this.toggleAutoUpdate.bind(this),this.myModel.changes.sub("changeOnload",this.updateOutputHandler),this.myModel.changes.sub("changeContent",this.updateOutputHandler),this.myModel.changes.sub("changeAutoUpdate",this.toggleAutoUpdateHandler)}var t,n,o;return t=e,(n=[{key:"toggleAutoUpdate",value:function(e){e.autoUpdate&&this.updateOutput(e)}},{key:"updateOutput",value:function(e){$("<iframe>",{id:"OUTPUT",class:"main__ouput-window",src:"",sandbox:"allow-forms allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts",style:"display: block;"}).replaceAll($("#OUTPUT"));var t=$("#OUTPUT")[0].contentWindow.document,n=null,o=[],a="",i=e.html;if(i&&(n=i.match(/<script>[\S\s]+?<\/script>/gim)),n)for(var s=0;s<n.length;s++)i=i.split(n[s]).join(""),o.push(n[s].slice(8,-9));o.push(e.js),o.length>0&&(a=o.join(";\n"));var r=i.match(/<head>[\S\s]+?<\/head>/gim),u=null;u=r?r[0].slice(6,-7):"";var c=i.match(/<body>[\S\s]+?<\/body>/gim),l=null;l=c?c[0].slice(6,-7):i,t.write("<html>\n\t\t\t<head>\n\t\t\t".concat(u," \t\t\t                          \n\t\t\t<style>").concat(e.css,"</style>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t").concat(l,"\t\t\t\n\t\t\t</body>\n\t\t\t</html>")),setTimeout(function(){$("<script>").text(a).appendTo(t.body)},500)}},{key:"unsubscribe",value:function(){this.myModel.changes.remove("changeOnload",this.updateOutputHandler),this.myModel.changes.remove("changeContent",this.updateOutputHandler),this.myModel.changes.remove("changeAutoUpdate",this.toggleAutoUpdateHandler)}}])&&A(t.prototype,n),o&&A(t,o),e}();function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.myModel=t,$("#AUTO-UPDATE").unbind("change"),$("#AUTO-UPDATE").change(this.autoUpdateChecked.bind(this))}var t,n,o;return t=e,(n=[{key:"_getData",value:function(){return{html:ace.edit("HTML").getValue(),css:ace.edit("CSS").getValue(),js:ace.edit("JS").getValue(),autoUpdate:$("#AUTO-UPDATE").prop("checked")}}},{key:"autoUpdateChecked",value:function(){var e=this._getData();this.myModel.setAutoUpdate(e)}}])&&x(t.prototype,n),o&&x(t,o),e}();function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var H="https://fe.it-academy.by/AjaxStringStorage2.php",D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user=localStorage.user,this.modelOfPromo=null,this.viewOfPromo=null,this.controllerOfPromo=null,this.viewOfPopup=null,this.controllerOfPopup=null,this.modelOfList=null,this.viewOfList=null,this.controllerOfList=null,this.modelOfProject=null,this.viewOfProject=null,this.controllerOfProject=null,this.viewOfUser=null,this.controllerOfUser=null,this.viewOfOutput=null,this.controllerOfOutput=null,this.createdHash=null,this.createPromise=function(e,t){return new Promise(function(n,o){try{$.ajax({url:H,type:"POST",cache:!1,dataType:"json",context:e,data:t,success:n,error:o})}catch(e){console.log(e)}})},window.addEventListener("hashchange",this.onhashchange.bind(this)),localStorage.user?""===document.location.hash||"#promo"===document.location.hash?this.navigateTo("#dashboard"):this.navigateTo(document.location.hash):
//!localStorage.user - при пустом попадаем на промо
this.navigateTo("#promo")}var t,n,o;return t=e,(n=[{key:"onhashchange",value:function(){var e=document.location.hash;this.route(e)}},{key:"route",value:function(e){var t=this;if("#test"!=e)if(e=e.substr(1),localStorage.user)if("dashboard"===e)this.modelOfList=new v(this.user),this.viewOfList=new _(this.modelOfList),this.controllerOfList=new O(this.modelOfList),this.modelOfList.changes.sub("logOut",this.logOutUser.bind(this)),this.modelOfList.changes.sub("createNewProject",this.navigateToNewProject.bind(this));else{if(!this.user)return;this.createPromise(this,{f:"READ",n:"CodeSpace"}).then(function(n){if(void 0!==n.error)alert(n.error);else if(""!==n){var o=JSON.parse(n.result),a=Object.keys(o[t.user].projects);t.createdHash&&a.push(t.createdHash);for(var i=0;i<a.length;i++)if(a[i]===e){t.modelOfProject&&(t.viewOfOutput.unsubscribe(),t.viewOfProject.unsubscribe()),t.modelOfProject=new U(e,t.user),t.viewOfUser=new M(t.modelOfProject),t.controllerOfUser=new E(t.modelOfProject),t.viewOfOutput=new L(t.modelOfProject),t.controllerOfOutput=new R(t.modelOfProject),t.viewOfProject=new j(t.modelOfProject),t.controllerOfProject=new S(t.modelOfProject),t.modelOfProject.changes.sub("logOut",t.logOutUser.bind(t)),t.modelOfProject.changes.sub("createNewProject",t.navigateToNewProject.bind(t));break}}}).catch(function(e){console.log("На этапе запроса на сервер случилась ошибка: "+e)})}else
//!localStorage.user - при пустом попадаем на промо
this.modelOfPromo=new u,this.viewOfPromo=new l(this.modelOfPromo),this.controllerOfPromo=new d(this.modelOfPromo),this.viewOfPopup=new f(this.modelOfPromo),this.controllerOfPopup=new b(this.modelOfPromo),this.modelOfPromo.changes.sub("changeUser",this.setUser.bind(this))}},{key:"navigateTo",value:function(e){document.location.hash===e?this.route(e):document.location.hash=e}},{key:"setUser",value:function(e){this.user=e,this.navigateTo("#dashboard")}},{key:"logOutUser",value:function(){this.user=null,this.navigateTo("#promo")}},{key:"navigateToNewProject",value:function(e){this.navigateTo("#project".concat(e)),this.createdHash="project".concat(e)}}])&&I(t.prototype,n),o&&I(t,o),e}();$(function(){o("HTML","ace/theme/monokai","ace/mode/html"),o("CSS","ace/theme/monokai","ace/mode/css"),o("JS","ace/theme/monokai","ace/mode/javascript"),new D})}]);
//# sourceMappingURL=bundle.js.map